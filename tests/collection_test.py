from datetime import datetime
from src.boltwood_parser import *

data = """
2023-11-08 00:00:53.53 C M  -15.2   26.2   26.2    9.8  19    0.6   0 0 0 00003 045238.00061 1 2 1 3 0 1
2023-11-08 00:01:03.03 C M  -14.9   26.2   26.2   10.7  19    0.6   0 0 0 00003 045238.00073 1 2 1 3 0 0
2023-11-08 00:01:13.13 C M  -15.3   26.2   26.2    9.9  19    0.6   0 0 0 00003 045238.00084 1 2 1 3 0 0
2023-11-08 00:01:23.23 C M  -15.2   26.2   26.2    9.4  19    0.6   0 0 0 00003 045238.00096 1 2 1 3 0 0
2023-11-08 00:01:33.33 C M  -15.3   26.2   26.2    9.2  19    0.6   0 0 0 00003 045238.00108 1 2 1 3 0 0
2023-11-08 00:01:43.43 C M  -15.2   26.2   26.2    9.0  19    0.6   0 0 0 00003 045238.00119 1 2 1 3 0 0
2023-11-08 00:01:53.53 C M  -15.2   26.2   26.2    8.6  19    0.6   0 0 0 00003 045238.00131 1 2 1 3 0 0
2023-11-08 00:02:03.03 C M  -15.2   26.2   26.1    7.8  19    0.6   0 0 0 00003 045238.00142 1 1 1 3 0 0
2023-11-08 00:02:13.13 C M  -15.0   26.1   26.1    8.2  19    0.6   0 0 0 00003 045238.00154 1 2 1 3 1 0
2023-11-08 00:02:23.23 C M  -15.2   26.1   26.1    8.1  19    0.6   0 0 0 00003 045238.00166 1 2 1 3 0 0
2023-11-08 00:02:33.33 C M  -15.2   26.1   26.1    8.0  19    0.6   0 0 0 00003 045238.00177 1 2 1 3 0 0
2023-11-08 00:02:46.46 C M  -15.0   26.1   26.1    8.4  19    0.6   0 0 0 00003 045238.00192 1 2 1 3 0 0
2023-11-08 00:02:55.55 C M  -15.0   26.1   26.1    9.5  19    0.6   0 0 0 00003 045238.00203 1 2 1 3 0 0
2023-11-08 00:03:05.05 C M  -15.2   26.1   26.2    9.5  19    0.6   0 0 0 00003 045238.00214 1 2 1 3 0 0
"""

def test_collection():
    collection = EntryCollection(data)
    assert len(collection.entries) == 14
    
    assert collection.find(datetime(2023, 11, 8, 0, 0, 0)).alert
    assert collection.find(datetime(2023, 11, 8, 0, 0, 50)).alert
    assert collection.find(datetime(2023, 11, 8, 0, 2, 10)).roof_closed
    assert collection.find(datetime(2023, 11, 8, 0, 2, 14)).roof_closed
